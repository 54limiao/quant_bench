# 量化配置: GPTQ W8A8 动态量化
name: gptq-w8a8-dynamic
description: 使用 GPTQ 算法进行 W8A8 动态量化

# 输入模型路径 (会自动替换为转换后的模型路径)
input_model: PLACEHOLDER_TRANS_OUTPUT

# 输出模型路径 (会自动添加后缀)
output_suffix: -R4-gptq-W8A8-dynamic

# Calibration 数据集配置
calibration:
  dataset_id: /dataset/workspace/lim42/datasets/ultra_chat_200k/
  dataset_split: train_sft
  num_samples: 512
  max_sequence_length: 2048

# llmcompressor 标准 recipe
recipe:
  quant_stage:
    quant_modifiers:
      SpinQuantModifier:
        rotations: ["R4"]
        transform_block_size: 256
        transform_type: "hadamard"
      GPTQModifier:
        actorder: null
        ignore: ["lm_head", "re:visual.*", "re:model.visual.*"]
        config_groups:
          group_0:
            weights: {num_bits: 8, type: int, symmetric: true, strategy: channel}
            input_activations: {num_bits: 8, type: int, symmetric: true, strategy: token, dynamic: true}
            targets: [Linear]

# 是否保存压缩版本
save_compressed: true